\chapter{Motif Adjacency Matrix Formulae} \label{chap:appendix_matrices}

We give explicit matrix-based formulae for functional motif adjacency matrices $M^\mathrm{func}$ for all simple motifs $\ca{M}$ on at most three vertices, along with the anchored motifs $\ca{M}_\mathrm{coll}$ and $\ca{M}_\mathrm{expa}$. For structural motif adjacency matrices, simply replace $J_\mathrm{n}$, $J$ and $G$ with $J_0$, $J_\mathrm{s}$ and $G_\mathrm{s}$ respectively. Entry-wise products are denoted by $\circ$.

\vspace*{0.2cm}
\begin{table}[H]

	\centering
	\renewcommand{\arraystretch}{1.8}
	\tiny
	
	\begin{tabular}{ |c|c|c|c| }
	
		\hline	
	
		Motif & $C$ & $C'$ & $M^\mathrm{func}$ \\
		
		\hline
		
		$\ca{M}_\mathrm{s}$ & & & $G + G^\top$ \\
		
		\hline
		
		$\ca{M}_\mathrm{d}$ & & & $\frac{1}{2} G_\mathrm{d}$ \\
		
		\hline
		
		$\ca{M}_1$ & $J^\top \circ (J G) + J^\top \circ (G J) + G^\top \circ (J J)$ & & $\frac{1}{3} \big(C + C^\top\big)$ \\
		
		\hline
		
		$\ca{M}_2$ & \rule{0pt}{2.7em}$\displaystyle\begin{aligned} 
       					& J^\top \circ (J_\mathrm{d} G) + J^\top \circ (G_\mathrm{d} J) + G^\top \circ (J_\mathrm{d} J)   \\
       					& + J^\top \circ (J G_\mathrm{d}) + J^\top \circ (G J_\mathrm{d}) + G^\top \circ (J J_\mathrm{d}) \\
       					& + J_\mathrm{d} \circ (J G) + J_\mathrm{d} \circ (G J) + G_\mathrm{d} \circ (J J)
    				\end{aligned}$\rule[-2em]{0pt}{1em} & & $\frac{1}{4} \big(C + C^\top\big)$ \\
    	
    	\hline
		
		$\ca{M}_3$ & \rule{0pt}{2.7em}$\displaystyle\begin{aligned}
						& J \circ (J_\mathrm{d} G_\mathrm{d}) + J \circ (G_\mathrm{d} J_\mathrm{d}) + G \circ (J_\mathrm{d} J_\mathrm{d}) \\
						& + J_\mathrm{d} \circ (J_\mathrm{d} G) + J_\mathrm{d} \circ (G_\mathrm{d} J) + G_\mathrm{d} \circ (J_\mathrm{d} J) \\
						& + J_\mathrm{d} \circ (J G_\mathrm{d}) + J_\mathrm{d} \circ (G J_\mathrm{d}) + G_\mathrm{d} \circ (J J_\mathrm{d})
					\end{aligned}$\rule[-2em]{0pt}{1em} & & $\frac{1}{5} \big(C + C^\top\big)$ \\
					
		\hline
		
		$\ca{M}_4$ & $ J_\mathrm{d} \circ (J_\mathrm{d} G_\mathrm{d}) + J_\mathrm{d} \circ (G_\mathrm{d} J_\mathrm{d}) + G_\mathrm{d} \circ (J_\mathrm{d} J_\mathrm{d}) $ & & $ \frac{1}{6} C$ \\
		
		\hline
		
		$\ca{M}_5$ & \rule{0pt}{2.7em}$\displaystyle\begin{aligned}
						& J \circ (J G) + J \circ (G J) + G \circ (J J) \\
						& + J \circ (J G^\top) + J \circ (G J^\top) + G \circ (J J^\top) \\
						& + J \circ (J^\top G) + J \circ (G^\top J) + G \circ (J^\top J)
					\end{aligned}$\rule[-2em]{0pt}{1em} & & $\frac{1}{3} \big(C + C^\top\big)$ \\

		\hline
		
		$\ca{M}_6$ & $J \circ (J G_\mathrm{d}) + J \circ (G J_\mathrm{d}) + G \circ (J J_\mathrm{d}) + J_\mathrm{d} \circ (J^\top G)$ & $G_\mathrm{d} \circ (J^\top J)$ & $\frac{1}{4} \big(C + C^\top + C' \big)$ \\
		
		\hline

		$\ca{M}_7$ & $J \circ (J_\mathrm{d} G) + J \circ (G_\mathrm{d} J) + G \circ (J_\mathrm{d} J)$ & $J_\mathrm{d} \circ (J G^\top) + J_\mathrm{d} \circ (G J^\top) + G_\mathrm{d} \circ (J J^\top)$ & $ \frac{1}{4} \big(C + C^\top + C' \big)$ \\
		
		\hline
		
		$\ca{M}_8$ & $J \circ (G J_\mathrm{n}) + G \circ (J J_\mathrm{n})$ & $J_\mathrm{n} \circ (J^\top G) + J_\mathrm{n} \circ (G^\top J)$ & $\frac{1}{2} \big(C + C^\top + C' \big)$ \\
		
		\hline
		
		$\ca{M}_9$ & \rule{0pt}{1.9em}$\displaystyle\begin{aligned}
						& J \circ (J_\mathrm{n} G^\top) + G \circ (J_\mathrm{n} J^\top) + J_\mathrm{n} \circ (J G) \\
						& + J_\mathrm{n} \circ (G J) + J \circ (G^\top J_\mathrm{n}) + G \circ (J^\top J_\mathrm{n})
					\end{aligned}$\rule[-1.3em]{0pt}{1em} & & $\frac{1}{2} \big(C + C^\top\big)$ \\
					
		\hline
		
		$\ca{M}_{10}$ & $J \circ (J_\mathrm{n} G) + G \circ (J_\mathrm{n} J)$ & $J_\mathrm{n} \circ (J G^\top) + J_\mathrm{n} \circ (G J^\top)$ & $\frac{1}{2} \big(C + C^\top + C' \big)$ \\
		
		\hline
		
		$\ca{M}_{11}$ & \rule{0pt}{1.9em}$\displaystyle\begin{aligned}
						& J_\mathrm{d} \circ (G J_\mathrm{n}) + G_\mathrm{d} \circ (J J_\mathrm{n}) + J_\mathrm{n} \circ (J_\mathrm{d} G) \\
						&  + J_\mathrm{n} \circ (G_\mathrm{d} J) + J \circ (G_\mathrm{d} J_\mathrm{n}) + G \circ (J_\mathrm{d} J_\mathrm{n})
					\end{aligned}$\rule[-1.3em]{0pt}{1em} & & $\frac{1}{3} \big(C + C^\top\big)$ \\
					
		\hline
		
		$\ca{M}_{12}$ & \rule{0pt}{1.9em}$\displaystyle\begin{aligned}
						& J_\mathrm{d} \circ (J_\mathrm{n} G) + G_\mathrm{d} \circ (J_\mathrm{n} J) + J_\mathrm{n} \circ (J G_\mathrm{d}) \\
						& + J_\mathrm{n} \circ (G J_\mathrm{d}) + J \circ (J_\mathrm{n} G_\mathrm{d}) + G \circ (J_\mathrm{n} J_\mathrm{d})
					\end{aligned}$\rule[-1.3em]{0pt}{1em} & & $ \frac{1}{3} \big(C + C^\top\big)$ \\
					
		\hline

		$\ca{M}_{13}$ & $J_\mathrm{d} \circ (G_\mathrm{d} J_\mathrm{n}) + G_\mathrm{d} \circ (J_\mathrm{d} J_\mathrm{n}) + J_\mathrm{n} \circ (J_\mathrm{d} G_\mathrm{d})$ & & $\frac{1}{4} \big(C + C^\top \big)$ \\
		
		\hline
		
		$\ca{M}_\mathrm{coll}$ & $J_\mathrm{n} \circ (J G^\top)$ & & $\frac{1}{2} \big( C + C^\top \big)$ \\
		
		\hline
		
		$\ca{M}_\mathrm{expa}$ & $J_\mathrm{n} \circ (J^\top G)$ & & $\frac{1}{2} \big( C + C^\top \big)$ \\
		
		\hline

	\end{tabular}
	\caption{Functional motif adjacency matrix formulae}
	\label{tab:motif_adj_mat_table}
\end{table}
